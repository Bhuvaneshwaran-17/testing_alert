name: Task 1 - Build Failure Alert

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Attempting Build
        run: |
          echo "Compiling..."
          exit 1

      - name: Alert Teams on Failure
        if: failure()
        env:
          TEAMS_URL: ${{ secrets.TESTING_WEBHOOK }}
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{
            \"type\": \"message\",
            \"attachments\": [{
              \"contentType\": \"application/vnd.microsoft.card.adaptive\",
              \"content\": {
                \"type\": \"AdaptiveCard\",
                \"body\": [
                  {\"type\": \"TextBlock\", \"text\": \"‚ùå BUILD FAILURE\", \"weight\": \"Bolder\", \"color\": \"Attention\", \"size\": \"Large\"},
                  {\"type\": \"TextBlock\", \"text\": \"Repository: **${{ github.repository }}**\", \"wrap\": true},
                  {\"type\": \"TextBlock\", \"text\": \"The build step failed.\", \"wrap\": true}
                ],
                \"\$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",
                \"version\": \"1.4\"
              }
            }]
          }" "$TEAMS_URL"
